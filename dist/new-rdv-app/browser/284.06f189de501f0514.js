"use strict";(self.webpackChunknew_rdv_app=self.webpackChunknew_rdv_app||[]).push([[284],{8284:(oo,It,g)=>{g.r(It),g.d(It,{ProfileModule:()=>to});var Z=g(6895),pt=g(9116),xe=g(6471),D=g(5861),mt=g(9646),ye=g(8746),ve=g(2084),o=g(4650),we=g(4961),Me=g(8306),et=g(8996),Ce=g(8372),Re=g(4004),Et=g(3900),X=g(5813),nt=g(2011),Ae=g(3942),it=g(9681),I=g(2090),zt=g(4859);const Pt="firebasestorage.googleapis.com",Ut="storageBucket";class b extends I.ZR{constructor(e,t){super(ft(e),`Firebase Storage: ${t} (${ft(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,b.prototype)}_codeEquals(e){return ft(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function ft(n){return"storage/"+n}function gt(){return new b("unknown","An unknown error occurred, please check the error payload for server response.")}function Ot(){return new b("canceled","User canceled the upload/download.")}function Ht(){return new b("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function q(n){return new b("invalid-argument",n)}function Bt(){return new b("app-deleted","The Firebase app was deleted.")}function Dt(n){return new b("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $(n,e){return new b("invalid-format","String does not match format '"+n+"': "+e)}function J(n){throw new b("internal-error","Internal error: "+n)}class M{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=M.makeFromUrl(e,t)}catch{return new M(e,"")}if(""===i.path)return i;throw function He(n){return new b("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)",c=new RegExp("^gs://"+r+"(/(.*))?$","i");function u(v){v.path_=decodeURIComponent(v.path)}const d=t.replace(/[.]/g,"\\."),y=[{regex:c,indices:{bucket:1,path:3},postModify:function a(v){"/"===v.path.charAt(v.path.length-1)&&(v.path_=v.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${d}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:u},{regex:new RegExp(`^https?://${t===Pt?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:u}];for(let v=0;v<y.length;v++){const H=y[v],B=H.regex.exec(e);if(B){let F=B[H.indices.path];F||(F=""),i=new M(B[H.indices.bucket],F),H.postModify(i);break}}if(null==i)throw function Oe(n){return new b("invalid-url","Invalid URL '"+n+"'.")}(e);return i}}class Fe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function ot(n){return"string"==typeof n||n instanceof String}function Lt(n){return _t()&&n instanceof Blob}function _t(){return typeof Blob<"u"}function bt(n,e,t,i){if(i<e)throw q(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw q(`Invalid value for '${n}'. Expected ${t} or less.`)}function U(n,e,t){let i=e;return null==t&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function Ft(n){const e=encodeURIComponent;let t="?";for(const i in n)n.hasOwnProperty(i)&&(t=t+(e(i)+"=")+e(n[i])+"&");return t=t.slice(0,-1),t}var L=(()=>{return(n=L||(L={}))[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",L;var n})();class Qe{constructor(e,t,i,r,a,s,c,l,u,h,d){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=a,this.additionalRetryCodes_=s,this.callback_=c,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,f)=>{this.resolve_=m,this.reject_=f,this.start_()})}start_(){const t=(i,r)=>{const a=this.resolve_,s=this.reject_,c=r.connection;if(r.wasSuccessCode)try{const l=this.callback_(c,c.getResponse());!function qe(n){return void 0!==n}(l)?a():a(l)}catch(l){s(l)}else if(null!==c){const l=gt();l.serverResponse=c.getErrorText(),s(this.errorCallback_?this.errorCallback_(c,l):l)}else s(r.canceled?this.appDelete_?Bt():Ot():function Ue(){return new b("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}())};this.canceled_?t(0,new rt(!1,null,!0)):this.backoffId_=function Ze(n,e,t){let i=1,r=null,a=null,s=!1,c=0;function l(){return 2===c}let u=!1;function h(...p){u||(u=!0,e.apply(null,p))}function d(p){r=setTimeout(()=>{r=null,n(f,l())},p)}function m(){a&&clearTimeout(a)}function f(p,...A){if(u)return void m();if(p)return m(),void h.call(null,p,...A);if(l()||s)return m(),void h.call(null,p,...A);let y;i<64&&(i*=2),1===c?(c=2,y=0):y=1e3*(i+Math.random()),d(y)}let _=!1;function x(p){_||(_=!0,m(),!u&&(null!==r?(p||(c=2),clearTimeout(r),d(0)):p||(c=1)))}return d(0),a=setTimeout(()=>{s=!0,x(!0)},t),x}((i,r)=>{if(r)return void i(!1,new rt(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const s=c=>{null!==this.progressCallback_&&this.progressCallback_(c.loaded,c.lengthComputable?c.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(s),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(s),this.pendingConnection_=null;const c=a.getErrorCode()===L.NO_ERROR,l=a.getStatus();if(!c||this.isRetryStatusCode_(l)){const h=a.getErrorCode()===L.ABORT;return void i(!1,new rt(!1,null,h))}const u=-1!==this.successCodes_.indexOf(l);i(!0,new rt(u,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function We(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,r=-1!==[408,429].indexOf(e),a=-1!==this.additionalRetryCodes_.indexOf(e);return t||r||a}}class rt{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function Ve(...n){const e=function Ke(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}if(_t())return new Blob(n);throw new b("unsupported-environment","This browser doesn't seem to support creating Blobs")}const k={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class xt{constructor(e,t){this.data=e,this.contentType=t||null}}function yt(n,e){switch(n){case k.RAW:return new xt(Zt(e));case k.BASE64:case k.BASE64URL:return new xt(Wt(n,e));case k.DATA_URL:return new xt(function on(n){const e=new qt(n);return e.base64?Wt(k.BASE64,e.rest):function nn(n){let e;try{e=decodeURIComponent(n)}catch{throw $(k.DATA_URL,"Malformed data URL.")}return Zt(e)}(e.rest)}(e),function rn(n){return new qt(n).contentType}(e))}throw gt()}function Zt(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);i<=127?e.push(i):i<=2047?e.push(192|i>>6,128|63&i):55296==(64512&i)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(i=65536|(1023&i)<<10|1023&n.charCodeAt(++t),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i)):e.push(239,191,189):56320==(64512&i)?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|63&i)}return new Uint8Array(e)}function Wt(n,e){switch(n){case k.BASE64:{const r=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(r||a)throw $(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case k.BASE64URL:{const r=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(r||a)throw $(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function en(n){return atob(n)}(e)}catch{throw $(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}class qt{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw $(k.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;null!=i&&(this.base64=function an(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}class E{constructor(e,t){let i=0,r="";Lt(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(Lt(this.data_)){const r=function tn(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===r?null:new E(r)}{const i=new Uint8Array(this.data_.buffer,e,t-e);return new E(i,!0)}}static getBlob(...e){if(_t()){const t=e.map(i=>i instanceof E?i.data_:i);return new E(Ve.apply(null,t))}{const t=e.map(s=>ot(s)?yt(k.RAW,s).data:s.data_);let i=0;t.forEach(s=>{i+=s.byteLength});const r=new Uint8Array(i);let a=0;return t.forEach(s=>{for(let c=0;c<s.length;c++)r[a++]=s[c]}),new E(r,!0)}}uploadData(){return this.data_}}function vt(n){let e;try{e=JSON.parse(n)}catch{return null}return function Ge(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function Nt(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function ln(n,e){return e}class C{constructor(e,t,i,r){this.server=e,this.local=t||e,this.writable=!!i,this.xform=r||ln}}let at=null;function K(){if(at)return at;const n=[];n.push(new C("bucket")),n.push(new C("generation")),n.push(new C("metageneration")),n.push(new C("name","fullPath",!0));const t=new C("name");t.xform=function e(a,s){return function un(n){return!ot(n)||n.length<2?n:Nt(n)}(s)},n.push(t);const r=new C("size");return r.xform=function i(a,s){return void 0!==s?Number(s):s},n.push(r),n.push(new C("timeCreated")),n.push(new C("updated")),n.push(new C("md5Hash",null,!0)),n.push(new C("cacheControl",null,!0)),n.push(new C("contentDisposition",null,!0)),n.push(new C("contentEncoding",null,!0)),n.push(new C("contentLanguage",null,!0)),n.push(new C("contentType",null,!0)),n.push(new C("metadata","customMetadata",!0)),at=n,at}function Gt(n,e,t){const i=vt(e);return null===i?null:function dn(n,e,t){const i={type:"file"},r=t.length;for(let a=0;a<r;a++){const s=t[a];i[s.local]=s.xform(i,e[s.server])}return function hn(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new M(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(i,n),i}(n,i,t)}function wt(n,e){const t={},i=e.length;for(let r=0;r<i;r++){const a=e[r];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const Qt="prefixes";class z{constructor(e,t,i,r){this.url=e,this.method=t,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function P(n){if(!n)throw gt()}function st(n,e){return function t(i,r){const a=Gt(n,r,e);return P(null!==a),a}}function N(n){return function e(t,i){let r;return r=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function ze(){return new b("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function Ee(){return new b("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function Ie(n){return new b("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function Pe(n){return new b("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):i,r.serverResponse=i.serverResponse,r}}function V(n){const e=N(n);return function t(i,r){let a=e(i,r);return 404===i.getStatus()&&(a=function Se(n){return new b("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=r.serverResponse,a}}function Yt(n,e,t){const r=U(e.fullServerUrl(),n.host,n._protocol),s=n.maxOperationRetryTime,c=new z(r,"GET",st(n,t),s);return c.errorHandler=V(e),c}function bn(n,e,t,i,r){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),i&&(a.pageToken=i),r&&(a.maxResults=r);const c=U(e.bucketOnlyServerUrl(),n.host,n._protocol),u=n.maxOperationRetryTime,h=new z(c,"GET",function gn(n,e){return function t(i,r){const a=function fn(n,e,t){const i=vt(t);return null===i?null:function mn(n,e,t){const i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[Qt])for(const r of t[Qt]){const a=r.replace(/\/$/,""),s=n._makeStorageReference(new M(e,a));i.prefixes.push(s)}if(t.items)for(const r of t.items){const a=n._makeStorageReference(new M(e,r.name));i.items.push(a)}return i}(n,e,i)}(n,e,r);return P(null!==a),a}}(n,e.bucket),u);return h.urlParams=a,h.errorHandler=N(e),h}function $t(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=function wn(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),i}class ct{constructor(e,t,i,r){this.current=e,this.total=t,this.finalized=!!i,this.metadata=r||null}}function Mt(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{P(!1)}return P(!!t&&-1!==(e||["active"]).indexOf(t)),t}const An={STATE_CHANGED:"state_changed"},R={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ct(n){switch(n){case"running":case"pausing":case"canceling":return R.RUNNING;case"paused":return R.PAUSED;case"success":return R.SUCCESS;case"canceled":return R.CANCELED;default:return R.ERROR}}class kn{constructor(e,t,i){if(function Ne(n){return"function"==typeof n}(e)||null!=t||null!=i)this.next=e,this.error=t??void 0,this.complete=i??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function G(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class Sn extends class Tn{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=L.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=L.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=L.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,r){if(this.sent_)throw J("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const a in r)r.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,r[a].toString());return void 0!==i?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw J("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw J("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw J("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw J("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function T(){return new Sn}class te{constructor(e,t,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=i,this._mappings=K(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{this._request=void 0,this._chunkMultiplier=1,r._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=r,this._transition("error"))},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals("canceled")?this.completeTransitions_():(this._error=r,this._transition("error"))},this._promise=new Promise((r,a)=>{this._resolve=r,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,i])=>{switch(this._state){case"running":e(t,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const i=function Mn(n,e,t,i,r){const a=e.bucketOnlyServerUrl(),s=$t(e,i,r),c={name:s.fullPath},l=U(a,n.host,n._protocol),h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},d=wt(s,t),_=new z(l,"POST",function f(x){let p;Mt(x);try{p=x.getResponseHeader("X-Goog-Upload-URL")}catch{P(!1)}return P(ot(p)),p},n.maxUploadRetryTime);return _.urlParams=c,_.headers=h,_.body=d,_.errorHandler=N(e),_}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,T,e,t);this._request=r,r.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,i)=>{const r=function Cn(n,e,t,i){const l=new z(t,"POST",function a(u){const h=Mt(u,["active","final"]);let d=null;try{d=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{P(!1)}d||P(!1);const m=Number(d);return P(!isNaN(m)),new ct(m,i.size(),"final"===h)},n.maxUploadRetryTime);return l.headers={"X-Goog-Upload-Command":"query"},l.errorHandler=N(e),l}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(r,T,t,i);this._request=a,a.getPromise().then(s=>{this._request=void 0,this._updateProgress(s.current),this._needToFetchStatus=!1,s.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new ct(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((r,a)=>{let s;try{s=function Rn(n,e,t,i,r,a,s,c){const l=new ct(0,0);if(s?(l.current=s.current,l.total=s.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw function De(){return new b("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const u=l.total-l.current;let h=u;r>0&&(h=Math.min(h,r));const d=l.current,_={"X-Goog-Upload-Command":h===u?"upload, finalize":"upload","X-Goog-Upload-Offset":`${l.current}`},x=i.slice(d,d+h);if(null===x)throw Ht();const y=new z(t,"POST",function p(v,H){const B=Mt(v,["active","final"]),Q=l.current+h,F=i.size();let tt;return tt="final"===B?st(e,a)(v,H):null,new ct(Q,F,"final"===B,tt)},e.maxUploadRetryTime);return y.headers=_,y.body=x.uploadData(),y.progressCallback=c||null,y.errorHandler=N(n),y}(this._ref._location,this._ref.storage,i,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(l){return this._error=l,void this._transition("error")}const c=this._ref.storage._makeRequest(s,T,r,a);this._request=c,c.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const i=Yt(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(i,T,e,t);this._request=r,r.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const i=function Jt(n,e,t,i,r){const a=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"},l=function c(){let y="";for(let v=0;v<2;v++)y+=Math.random().toString().slice(2);return y}();s["Content-Type"]="multipart/related; boundary="+l;const u=$t(e,i,r),h=wt(u,t),f=E.getBlob("--"+l+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+h+"\r\n--"+l+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",i,"\r\n--"+l+"--");if(null===f)throw Ht();const _={name:u.fullPath},x=U(a,n.host,n._protocol),A=n.maxUploadRetryTime,w=new z(x,"POST",st(n,t),A);return w.urlParams=_,w.headers=s,w.body=f.uploadData(),w.errorHandler=N(e),w}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,T,e,t);this._request=r,r.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=Ot(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Ct(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,i,r){const a=new kn(t||void 0,i||void 0,r||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Ct(this._state)){case R.SUCCESS:G(this._resolve.bind(null,this.snapshot))();break;case R.CANCELED:case R.ERROR:G(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Ct(this._state)){case R.RUNNING:case R.PAUSED:e.next&&G(e.next.bind(e,this.snapshot))();break;case R.SUCCESS:e.complete&&G(e.complete.bind(e))();break;default:e.error&&G(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class W{constructor(e,t){this._service=e,this._location=t instanceof M?t:M.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new W(e,t)}get root(){const e=new M(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Nt(this._location.path)}get storage(){return this._service}get parent(){const e=function sn(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new M(this._location.bucket,e);return new W(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw Dt(e)}}function ne(n,e,t){return Rt.apply(this,arguments)}function Rt(){return(Rt=(0,D.Z)(function*(n,e,t){const r=yield ie(n,{pageToken:t});e.prefixes.push(...r.prefixes),e.items.push(...r.items),null!=r.nextPageToken&&(yield ne(n,e,r.nextPageToken))})).apply(this,arguments)}function ie(n,e){null!=e&&"number"==typeof e.maxResults&&bt("options.maxResults",1,1e3,e.maxResults);const t=e||{},i=bn(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,T)}function Zn(n){n._throwIfRoot("getDownloadURL");const e=function xn(n,e,t){const r=U(e.fullServerUrl(),n.host,n._protocol),s=n.maxOperationRetryTime,c=new z(r,"GET",function _n(n,e){return function t(i,r){const a=Gt(n,r,e);return P(null!==a),function pn(n,e,t,i){const r=vt(e);if(null===r||!ot(r.downloadTokens))return null;const a=r.downloadTokens;if(0===a.length)return null;const s=encodeURIComponent;return a.split(",").map(u=>{const d=n.fullPath;return U("/b/"+s(n.bucket)+"/o/"+s(d),t,i)+Ft({alt:"media",token:u})})[0]}(a,r,n.host,n._protocol)}}(n,t),s);return c.errorHandler=V(e),c}(n.storage,n._location,K());return n.storage.makeRequestWithTokens(e,T).then(t=>{if(null===t)throw function Le(){return new b("no-download-url","The given file does not have any download URLs.")}();return t})}function oe(n,e){const t=function cn(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),i=new M(n._location.bucket,t);return new W(n.storage,i)}function re(n,e){if(n instanceof At){const t=n;if(null==t._bucket)throw function Be(){return new b("no-default-bucket","No default bucket found. Did you set the '"+Ut+"' property when initializing the app?")}();const i=new W(t,t._bucket);return null!=e?re(i,e):i}return void 0!==e?oe(n,e):n}function Gn(n,e){if(e&&function qn(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof At)return function Nn(n,e){return new W(n,e)}(n,e);throw q("To use ref(service, url), the first argument must be a Storage instance.")}return re(n,e)}function ae(n,e){const t=e?.[Ut];return null==t?null:M.makeFromBucketSpec(t,n)}class At{constructor(e,t,i,r,a){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=a,this._bucket=null,this._host=Pt,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?M.makeFromBucketSpec(r,this._host):ae(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?M.makeFromBucketSpec(this._url,e):ae(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){bt("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){bt("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,D.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const i=yield t.getToken();if(null!==i)return i.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,D.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new W(this,e)}_makeRequest(e,t,i,r){if(this._deleted)return new Fe(Bt());{const a=function Je(n,e,t,i,r,a){const s=Ft(n.urlParams),c=n.url+s,l=Object.assign({},n.headers);return function Xe(n,e){e&&(n["X-Firebase-GMPID"]=e)}(l,e),function je(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(l,t),function Ye(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(l,a),function $e(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(l,i),new Qe(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r)}(e,this._appId,i,r,t,this._firebaseVersion);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}makeRequestWithTokens(e,t){var i=this;return(0,D.Z)(function*(){const[r,a]=yield Promise.all([i._getAuthToken(),i._getAppCheckToken()]);return i._makeRequest(e,t,r,a).getPromise()})()}}const se="@firebase/storage";function ue(n,e){return Gn(n=(0,I.m9)(n),e)}function ni(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new At(t,i,r,e,it.SDK_VERSION)}!function ii(){(0,it._registerComponent)(new zt.wA("storage",ni,"PUBLIC").setMultipleInstances(!0)),(0,it.registerVersion)(se,"0.9.7",""),(0,it.registerVersion)(se,"0.9.7","esm2017")}();class lt{constructor(e,t,i){this._delegate=e,this.task=t,this.ref=i}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class he{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new lt(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(i=>{if(e)return e(new lt(i,this,this._ref))},t)}on(e,t,i,r){let a;return t&&(a="function"==typeof t?s=>t(new lt(s,this,this._ref)):{next:t.next?s=>t.next(new lt(s,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,i||void 0,r||void 0)}}class de{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new O(e,this._service))}get items(){return this._delegate.items.map(e=>new O(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class O{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function ti(n,e){return oe(n,e)}(this._delegate,e);return new O(t,this.storage)}get root(){return new O(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new O(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new he(function jn(n,e,t){return function Hn(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new te(n,new E(e),t)}(n=(0,I.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=k.RAW,i){this._throwIfRoot("putString");const r=yt(t,e),a=Object.assign({},i);return null==a.contentType&&null!=r.contentType&&(a.contentType=r.contentType),new he(new te(this._delegate,new E(r.data,!0),a),this)}listAll(){return function Jn(n){return function Dn(n){const e={prefixes:[],items:[]};return ne(n,e).then(()=>e)}(n=(0,I.m9)(n))}(this._delegate).then(e=>new de(e,this.storage))}list(e){return function $n(n,e){return ie(n=(0,I.m9)(n),e)}(this._delegate,e||void 0).then(t=>new de(t,this.storage))}getMetadata(){return function Yn(n){return function Ln(n){n._throwIfRoot("getMetadata");const e=Yt(n.storage,n._location,K());return n.storage.makeRequestWithTokens(e,T)}(n=(0,I.m9)(n))}(this._delegate)}updateMetadata(e){return function Xn(n,e){return function Fn(n,e){n._throwIfRoot("updateMetadata");const t=function yn(n,e,t,i){const a=U(e.fullServerUrl(),n.host,n._protocol),c=wt(t,i),u=n.maxOperationRetryTime,h=new z(a,"PATCH",st(n,i),u);return h.headers={"Content-Type":"application/json; charset=utf-8"},h.body=c,h.errorHandler=V(e),h}(n.storage,n._location,e,K());return n.storage.makeRequestWithTokens(t,T)}(n=(0,I.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function Kn(n){return Zn(n=(0,I.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function Vn(n){return function Wn(n){n._throwIfRoot("deleteObject");const e=function vn(n,e){const i=U(e.fullServerUrl(),n.host,n._protocol),c=new z(i,"DELETE",function s(l,u){},n.maxOperationRetryTime);return c.successCodes=[200,204],c.errorHandler=V(e),c}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,T)}(n=(0,I.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw Dt(e)}}class pe{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(me(e))throw q("ref() expected a child path but got a URL, use refFromURL instead.");return new O(ue(this._delegate,e),this)}refFromURL(e){if(!me(e))throw q("refFromURL() expected a full URL but got a child path, use ref() instead.");try{M.makeFromUrl(e,this._delegate.host)}catch{throw q("refFromUrl() expected a valid full URL but got an invalid one.")}return new O(ue(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,i={}){!function ei(n,e,t,i={}){!function Qn(n,e,t,i={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:r}=i;r&&(n._overrideAuthToken="string"==typeof r?r:(0,I.Sg)(r,n.app.options.projectId))}(n,e,t,i)}(this._delegate,e,t,i)}}function me(n){return/^[A-Za-z]+:\/\//.test(n)}function si(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),i=n.getProvider("storage").getImmediate({identifier:e});return new pe(t,i)}!function ci(n){const e={TaskState:R,TaskEvent:An,StringFormat:k,Storage:pe,Reference:O};n.INTERNAL.registerComponent(new zt.wA("storage-compat",si,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.15")}(Ae.Z);var li=g(440);function fe(n){const e=function ui(n){return new Me.y(e=>{const t=s=>e.next(s);t(n.snapshot);const a=n.on("state_changed",t);return n.then(s=>{t(s),e.complete()},s=>{t(n.snapshot),(s=>{e.error(s)})(s)}),function(){a()}}).pipe((0,Ce.b)(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,Re.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function ut(n){return{getDownloadURL:()=>(0,mt.of)(void 0).pipe(X.fc,(0,Et.w)(()=>n.getDownloadURL()),X.iC),getMetadata:()=>(0,mt.of)(void 0).pipe(X.fc,(0,Et.w)(()=>n.getMetadata()),X.iC),delete:()=>(0,et.D)(n.delete()),child:e=>ut(n.child(e)),updateMetadata:e=>(0,et.D)(n.updateMetadata(e)),put:(e,t)=>fe(n.put(e,t)),putString:(e,t,i)=>fe(n.putString(e,t,i)),list:e=>(0,et.D)(n.list(e)),listAll:()=>(0,et.D)(n.listAll())}}g(127);const hi=new o.OlP("angularfire2.storageBucket"),di=new o.OlP("angularfire2.storage.maxUploadRetryTime"),pi=new o.OlP("angularfire2.storage.maxOperationRetryTime"),mi=new o.OlP("angularfire2.storage.use-emulator");let fi=(()=>{class n{constructor(t,i,r,a,s,c,l,u,h,d){const m=(0,nt.on)(t,s,i);this.storage=(0,nt.cc)(`${m.name}.storage.${r}`,"AngularFireStorage",m.name,()=>{const f=s.runOutsideAngular(()=>m.storage(r||void 0)),_=h;return _&&f.useEmulator(..._),l&&f.setMaxUploadRetryTime(l),u&&f.setMaxOperationRetryTime(u),f},[l,u])}ref(t){return ut(this.storage.ref(t))}refFromURL(t){return ut(this.storage.refFromURL(t))}upload(t,i,r){return ut(this.storage.ref(t)).put(i,r)}}return n.\u0275fac=function(t){return new(t||n)(o.LFG(nt.Dh),o.LFG(nt.xv,8),o.LFG(hi,8),o.LFG(o.Lbi),o.LFG(o.R0b),o.LFG(X.HU),o.LFG(di,8),o.LFG(pi,8),o.LFG(mi,8),o.LFG(li.nm,8))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})();var gi=g(2824),_i=g(1481);const bi=["wrapper"],xi=["sourceImage"];function yi(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"img",4,5),o.NdJ("load",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.imageLoadedInView())}),o.qZA()}if(2&n){const t=o.oxw();o.Udp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),o.Q6J("src",t.safeImgDataUrl,o.LSH)}}function vi(n,e){if(1&n){const t=o.EpF();o.ynx(0),o.TgZ(1,"span",9),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"topleft"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"topleft"))}),o._UZ(2,"span",10),o.qZA(),o.TgZ(3,"span",11),o._UZ(4,"span",10),o.qZA(),o.TgZ(5,"span",12),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"topright"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"topright"))}),o._UZ(6,"span",10),o.qZA(),o.TgZ(7,"span",13),o._UZ(8,"span",10),o.qZA(),o.TgZ(9,"span",14),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"bottomright"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"bottomright"))}),o._UZ(10,"span",10),o.qZA(),o.TgZ(11,"span",15),o._UZ(12,"span",10),o.qZA(),o.TgZ(13,"span",16),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"bottomleft"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"bottomleft"))}),o._UZ(14,"span",10),o.qZA(),o.TgZ(15,"span",17),o._UZ(16,"span",10),o.qZA(),o.TgZ(17,"span",18),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"top"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"top"))}),o.qZA(),o.TgZ(18,"span",19),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"right"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"right"))}),o.qZA(),o.TgZ(19,"span",20),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"bottom"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"bottom"))}),o.qZA(),o.TgZ(20,"span",21),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"left"))})("touchstart",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.startMove(r,a.moveTypes.Resize,"left"))}),o.qZA(),o.BQk()}}function wi(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"div",6),o.NdJ("keydown",function(r){o.CHM(t);const a=o.oxw();return o.KtG(a.keyboardAccess(r))}),o.TgZ(1,"div",7),o.NdJ("mousedown",function(r){o.CHM(t);const a=o.oxw();return o.KtG(a.startMove(r,a.moveTypes.Move))})("touchstart",function(r){o.CHM(t);const a=o.oxw();return o.KtG(a.startMove(r,a.moveTypes.Move))}),o.qZA(),o.YNc(2,vi,21,0,"ng-container",8),o.qZA()}if(2&n){const t=o.oxw();o.Udp("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),o.ekj("ngx-ic-round",t.roundCropper),o.xp6(2),o.Q6J("ngIf",!t.hideResizeSquares)}}class Mi{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(e){Object.keys(e).filter(t=>t in this).forEach(t=>this[t]=e[t]),this.validateOptions()}setOptionsFromChanges(e){Object.keys(e).filter(t=>t in this).forEach(t=>this[t]=e[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var S=(()=>{return(n=S||(S={})).Move="move",n.Resize="resize",n.Pinch="pinch",S;var n})();function ge(n,e){return n/100*e}let Ti=(()=>{class n{crop(t,i,r,a){const s=this.getImagePosition(t,i,r,a),c=s.x2-s.x1,l=s.y2-s.y1,u=document.createElement("canvas");u.width=c,u.height=l;const h=u.getContext("2d");if(!h)return null;null!=a.backgroundColor&&(h.fillStyle=a.backgroundColor,h.fillRect(0,0,c,l));const d=(a.transform.scale||1)*(a.transform.flipH?-1:1),m=(a.transform.scale||1)*(a.transform.flipV?-1:1),f=i.transformed;h.setTransform(d,0,0,m,f.size.width/2,f.size.height/2),h.translate(-s.x1/d,-s.y1/m),h.rotate((a.transform.rotate||0)*Math.PI/180);const _=a.transform.translateH?ge(a.transform.translateH,f.size.width):0,x=a.transform.translateV?ge(a.transform.translateV,f.size.height):0;h.drawImage(f.image,_-f.size.width/2,x-f.size.height/2);const p={width:c,height:l,imagePosition:s,cropperPosition:{...r}};a.containWithinAspectRatio&&(p.offsetImagePosition=this.getOffsetImagePosition(t,i,r,a));const A=this.getResizeRatio(c,l,a);return 1!==A&&(p.width=Math.round(c*A),p.height=a.maintainAspectRatio?Math.round(p.width/a.aspectRatio):Math.round(l*A),function ki(n,e,t){const i=n.width,r=n.height,a=i/(e=Math.round(e)),s=r/(t=Math.round(t)),c=Math.ceil(a/2),l=Math.ceil(s/2),u=n.getContext("2d");if(u){const h=u.getImageData(0,0,i,r),d=u.createImageData(e,t),m=h.data,f=d.data;for(let _=0;_<t;_++)for(let x=0;x<e;x++){const p=4*(x+_*e),A=_*s;let w=0,y=0,v=0,H=0,B=0,Q=0,F=0;const tt=Math.floor(x*a),eo=Math.floor(_*s);let Tt=Math.ceil((x+1)*a),St=Math.ceil((_+1)*s);Tt=Math.min(Tt,i),St=Math.min(St,r);for(let ht=eo;ht<St;ht++){const _e=Math.abs(A-ht)/l,no=x*a,io=_e*_e;for(let dt=tt;dt<Tt;dt++){const be=Math.abs(no-dt)/c,j=Math.sqrt(io+be*be);if(j>=1)continue;w=2*j*j*j-3*j*j+1;const Y=4*(dt+ht*i);F+=w*m[Y+3],v+=w,m[Y+3]<255&&(w=w*m[Y+3]/250),H+=w*m[Y],B+=w*m[Y+1],Q+=w*m[Y+2],y+=w}}f[p]=H/y,f[p+1]=B/y,f[p+2]=Q/y,f[p+3]=F/v}n.width=e,n.height=t,u.putImageData(d,0,0)}}(u,p.width,p.height)),p.base64=u.toDataURL("image/"+a.format,this.getQuality(a)),p}getImagePosition(t,i,r,a){const c=i.transformed.size.width/t.nativeElement.offsetWidth,l={x1:Math.round(r.x1*c),y1:Math.round(r.y1*c),x2:Math.round(r.x2*c),y2:Math.round(r.y2*c)};return a.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,i.transformed.size.width),l.y2=Math.min(l.y2,i.transformed.size.height)),l}getOffsetImagePosition(t,i,r,a){const l=i.transformed.size.width/t.nativeElement.offsetWidth;let u,h;(a.canvasRotation+i.exifTransform.rotate)%2?(u=(i.transformed.size.width-i.original.size.height)/2,h=(i.transformed.size.height-i.original.size.width)/2):(u=(i.transformed.size.width-i.original.size.width)/2,h=(i.transformed.size.height-i.original.size.height)/2);const d={x1:Math.round(r.x1*l)-u,y1:Math.round(r.y1*l)-h,x2:Math.round(r.x2*l)-u,y2:Math.round(r.y2*l)-h};return a.containWithinAspectRatio||(d.x1=Math.max(d.x1,0),d.y1=Math.max(d.y1,0),d.x2=Math.min(d.x2,i.transformed.size.width),d.y2=Math.min(d.y2,i.transformed.size.height)),d}getResizeRatio(t,i,r){const a=r.resizeToWidth/t,s=r.resizeToHeight/i,c=new Array;r.resizeToWidth>0&&c.push(a),r.resizeToHeight>0&&c.push(s);const l=0===c.length?1:Math.min(...c);return l>1&&!r.onlyScaleDown?l:Math.min(l,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Si=(()=>{class n{resetCropperPosition(t,i,r){if(!t?.nativeElement)return;const a=t.nativeElement;if(r.cropperStaticHeight&&r.cropperStaticWidth)i.x1=0,i.x2=a.offsetWidth>r.cropperStaticWidth?r.cropperStaticWidth:a.offsetWidth,i.y1=0,i.y2=a.offsetHeight>r.cropperStaticHeight?r.cropperStaticHeight:a.offsetHeight;else{const s=Math.min(r.cropperScaledMaxWidth,a.offsetWidth),c=Math.min(r.cropperScaledMaxHeight,a.offsetHeight);if(r.maintainAspectRatio)if(a.offsetWidth/r.aspectRatio<a.offsetHeight){i.x1=0,i.x2=s;const l=s/r.aspectRatio;i.y1=(a.offsetHeight-l)/2,i.y2=i.y1+l}else{i.y1=0,i.y2=c;const l=c*r.aspectRatio;i.x1=(a.offsetWidth-l)/2,i.x2=i.x1+l}else i.x1=0,i.x2=s,i.y1=0,i.y2=c}}move(t,i,r){const a=this.getClientX(t)-i.clientX,s=this.getClientY(t)-i.clientY;r.x1=i.x1+a,r.y1=i.y1+s,r.x2=i.x2+a,r.y2=i.y2+s}resize(t,i,r,a,s){const c=this.getClientX(t)-i.clientX,l=this.getClientY(t)-i.clientY;switch(i.position){case"left":r.x1=Math.min(Math.max(i.x1+c,r.x2-s.cropperScaledMaxWidth),r.x2-s.cropperScaledMinWidth);break;case"topleft":r.x1=Math.min(Math.max(i.x1+c,r.x2-s.cropperScaledMaxWidth),r.x2-s.cropperScaledMinWidth),r.y1=Math.min(Math.max(i.y1+l,r.y2-s.cropperScaledMaxHeight),r.y2-s.cropperScaledMinHeight);break;case"top":r.y1=Math.min(Math.max(i.y1+l,r.y2-s.cropperScaledMaxHeight),r.y2-s.cropperScaledMinHeight);break;case"topright":r.x2=Math.max(Math.min(i.x2+c,r.x1+s.cropperScaledMaxWidth),r.x1+s.cropperScaledMinWidth),r.y1=Math.min(Math.max(i.y1+l,r.y2-s.cropperScaledMaxHeight),r.y2-s.cropperScaledMinHeight);break;case"right":r.x2=Math.max(Math.min(i.x2+c,r.x1+s.cropperScaledMaxWidth),r.x1+s.cropperScaledMinWidth);break;case"bottomright":r.x2=Math.max(Math.min(i.x2+c,r.x1+s.cropperScaledMaxWidth),r.x1+s.cropperScaledMinWidth),r.y2=Math.max(Math.min(i.y2+l,r.y1+s.cropperScaledMaxHeight),r.y1+s.cropperScaledMinHeight);break;case"bottom":r.y2=Math.max(Math.min(i.y2+l,r.y1+s.cropperScaledMaxHeight),r.y1+s.cropperScaledMinHeight);break;case"bottomleft":r.x1=Math.min(Math.max(i.x1+c,r.x2-s.cropperScaledMaxWidth),r.x2-s.cropperScaledMinWidth),r.y2=Math.max(Math.min(i.y2+l,r.y1+s.cropperScaledMaxHeight),r.y1+s.cropperScaledMinHeight);break;case"center":const u=t.scale,h=Math.min(Math.max(s.cropperScaledMinWidth,Math.abs(i.x2-i.x1)*u),s.cropperScaledMaxWidth),d=Math.min(Math.max(s.cropperScaledMinHeight,Math.abs(i.y2-i.y1)*u),s.cropperScaledMaxHeight);r.x1=i.clientX-h/2,r.x2=i.clientX+h/2,r.y1=i.clientY-d/2,r.y2=i.clientY+d/2,r.x1<0?(r.x2-=r.x1,r.x1=0):r.x2>a.width&&(r.x1-=r.x2-a.width,r.x2=a.width),r.y1<0?(r.y2-=r.y1,r.y1=0):r.y2>a.height&&(r.y1-=r.y2-a.height,r.y2=a.height)}s.maintainAspectRatio&&this.checkAspectRatio(i.position,r,a,s)}checkAspectRatio(t,i,r,a){let s=0,c=0;switch(t){case"top":i.x2=i.x1+(i.y2-i.y1)*a.aspectRatio,s=Math.max(i.x2-r.width,0),c=Math.max(0-i.y1,0),(s>0||c>0)&&(i.x2-=c*a.aspectRatio>s?c*a.aspectRatio:s,i.y1+=c*a.aspectRatio>s?c:s/a.aspectRatio);break;case"bottom":i.x2=i.x1+(i.y2-i.y1)*a.aspectRatio,s=Math.max(i.x2-r.width,0),c=Math.max(i.y2-r.height,0),(s>0||c>0)&&(i.x2-=c*a.aspectRatio>s?c*a.aspectRatio:s,i.y2-=c*a.aspectRatio>s?c:s/a.aspectRatio);break;case"topleft":i.y1=i.y2-(i.x2-i.x1)/a.aspectRatio,s=Math.max(0-i.x1,0),c=Math.max(0-i.y1,0),(s>0||c>0)&&(i.x1+=c*a.aspectRatio>s?c*a.aspectRatio:s,i.y1+=c*a.aspectRatio>s?c:s/a.aspectRatio);break;case"topright":i.y1=i.y2-(i.x2-i.x1)/a.aspectRatio,s=Math.max(i.x2-r.width,0),c=Math.max(0-i.y1,0),(s>0||c>0)&&(i.x2-=c*a.aspectRatio>s?c*a.aspectRatio:s,i.y1+=c*a.aspectRatio>s?c:s/a.aspectRatio);break;case"right":case"bottomright":i.y2=i.y1+(i.x2-i.x1)/a.aspectRatio,s=Math.max(i.x2-r.width,0),c=Math.max(i.y2-r.height,0),(s>0||c>0)&&(i.x2-=c*a.aspectRatio>s?c*a.aspectRatio:s,i.y2-=c*a.aspectRatio>s?c:s/a.aspectRatio);break;case"left":case"bottomleft":i.y2=i.y1+(i.x2-i.x1)/a.aspectRatio,s=Math.max(0-i.x1,0),c=Math.max(i.y2-r.height,0),(s>0||c>0)&&(i.x1+=c*a.aspectRatio>s?c*a.aspectRatio:s,i.y2-=c*a.aspectRatio>s?c:s/a.aspectRatio);break;case"center":i.x2=i.x1+(i.y2-i.y1)*a.aspectRatio,i.y2=i.y1+(i.x2-i.x1)/a.aspectRatio;const l=Math.max(0-i.x1,0),u=Math.max(i.x2-r.width,0),h=Math.max(i.y2-r.height,0),d=Math.max(0-i.y1,0);(l>0||u>0||h>0||d>0)&&(i.x1+=h*a.aspectRatio>l?h*a.aspectRatio:l,i.x2-=d*a.aspectRatio>u?d*a.aspectRatio:u,i.y1+=d*a.aspectRatio>u?d:u/a.aspectRatio,i.y2-=h*a.aspectRatio>l?h:l/a.aspectRatio)}}getClientX(t){return t.touches?.[0].clientX||t.clientX||0}getClientY(t){return t.touches?.[0].clientY||t.clientY||0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();let Oi=(()=>{class n{constructor(){this.autoRotateSupported=function Ei(){return new Promise(n=>{const e=new Image;e.onload=()=>{n(1===e.width&&2===e.height)},e.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,i){return new Promise((r,a)=>{const s=new FileReader;s.onload=c=>{this.loadImage(c.target.result,t.type,i).then(r).catch(a)},s.readAsDataURL(t)})}loadImage(t,i,r){return this.isValidImageType(i)?this.loadBase64Image(t,r):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(t)}loadImageFromURL(t,i){return new Promise((r,a)=>{const s=new Image;s.onerror=()=>a,s.onload=()=>{const c=document.createElement("canvas"),l=c.getContext("2d");c.width=s.width,c.height=s.height,l?.drawImage(s,0,0),this.loadBase64Image(c.toDataURL(),i).then(r)},s.crossOrigin="anonymous",s.src=t})}loadBase64Image(t,i){return new Promise((r,a)=>{const s=new Image;s.onload=()=>r({originalImage:s,originalBase64:t}),s.onerror=a,s.src=t}).then(r=>this.transformImageBase64(r,i))}transformImageBase64(t,i){var r=this;return(0,D.Z)(function*(){const a=yield r.autoRotateSupported,s=yield function zi(n){switch("string"==typeof n&&(n=function Pi(n){const e=new DataView(function Ui(n){n=n.replace(/^data\:([^\;]+)\;base64,/gim,"");const e=atob(n),t=e.length,i=new Uint8Array(t);for(let r=0;r<t;r++)i[r]=e.charCodeAt(r);return i.buffer}(n));if(65496!==e.getUint16(0,!1))return-2;const t=e.byteLength;let i=2;for(;i<t;){if(e.getUint16(i+2,!1)<=8)return-1;const r=e.getUint16(i,!1);if(i+=2,65505==r){if(1165519206!==e.getUint32(i+=2,!1))return-1;const a=18761==e.getUint16(i+=6,!1);i+=e.getUint32(i+4,a);const s=e.getUint16(i,a);i+=2;for(let c=0;c<s;c++)if(274==e.getUint16(i+12*c,a))return e.getUint16(i+12*c+8,a)}else{if(65280!=(65280&r))break;i+=e.getUint16(i,!1)}}return-1}(n)),n){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(a?-1:t.originalBase64);return t.originalImage&&t.originalImage.complete?r.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:s},i):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(t,i){var r=this;return(0,D.Z)(function*(){const a=i.canvasRotation+t.exifTransform.rotate,s={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===a&&!t.exifTransform.flip&&!i.containWithinAspectRatio)return{original:{base64:t.original.base64,image:t.original.image,size:{...s}},transformed:{base64:t.original.base64,image:t.original.image,size:{...s}},exifTransform:t.exifTransform};const c=r.getTransformedSize(s,t.exifTransform,i),l=document.createElement("canvas");l.width=c.width,l.height=c.height;const u=l.getContext("2d");u?.setTransform(t.exifTransform.flip?-1:1,0,0,1,l.width/2,l.height/2),u?.rotate(Math.PI*(a/2)),u?.drawImage(t.original.image,-s.width/2,-s.height/2);const h=l.toDataURL(),d=yield r.loadImageFromBase64(h);return{original:{base64:t.original.base64,image:t.original.image,size:{...s}},transformed:{base64:h,image:d,size:{width:d.width,height:d.height}},exifTransform:t.exifTransform}})()}loadImageFromBase64(t){return new Promise((i,r)=>{const a=new Image;a.onload=()=>i(a),a.onerror=r,a.src=t})}getTransformedSize(t,i,r){const a=r.canvasRotation+i.rotate;if(r.containWithinAspectRatio){if(a%2){const c=t.height/r.aspectRatio;return{width:Math.max(t.height,t.width*r.aspectRatio),height:Math.max(t.width,c)}}{const c=t.width/r.aspectRatio;return{width:Math.max(t.width,t.height*r.aspectRatio),height:Math.max(t.height,c)}}}return a%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Hi=(()=>{class n{constructor(t,i,r,a,s){this.cropService=t,this.cropperPositionService=i,this.loadImageService=r,this.sanitizer=a,this.cd=s,this.Hammer=window?.Hammer||null,this.settings=new Mi,this.setImageMaxSizeRetries=0,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=S,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.imageCropped=new o.vpe,this.startCropImage=new o.vpe,this.imageLoaded=new o.vpe,this.cropperReady=new o.vpe,this.loadImageFailed=new o.vpe,this.reset()}ngOnChanges(t){this.onChangesUpdateSettings(t),this.onChangesInputImage(t),this.loadedImage?.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(t.maintainAspectRatio||t.aspectRatio)?this.resetCropperPosition():t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop())}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle("scaleX("+(this.transform.scale||1)*(this.transform.flipH?-1:1)+")scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+")rotate("+(this.transform.rotate||0)+`deg)translate(${this.transform.translateH||0}%, ${this.transform.translateV||0}%)`)}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){!this.loadedImage||(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize())}activatePinchGesture(){if(this.Hammer){const t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,o.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const i=+t.key;i>=1&&i<=9&&(this.settings.stepSize=i)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const r=t.shiftKey?S.Resize:S.Move,a=t.altKey?function Ri(n){switch(n){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function Ci(n){switch(n){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),s=function Ai(n,e){switch(n){case"ArrowUp":return{clientX:0,clientY:-1*e};case"ArrowRight":return{clientX:e,clientY:0};case"ArrowDown":return{clientX:0,clientY:e};default:return{clientX:-1*e,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},r,a),this.moveImg(s),this.moveStop()}startMove(t,i,r=null){this.moveStart?.active&&this.moveStart?.type===S.Pinch||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:i,position:r,clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t),...this.cropper})}startPinch(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:S.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}moveImg(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===S.Move?(this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0)):this.moveStart.type===S.Resize&&(!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===S.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){const t=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/t:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/t:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(null!=this.loadedImage?.transformed?.image){this.startCropImage.emit();const t=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=t&&this.imageCropped.emit(t),t}return null}}return n.\u0275fac=function(t){return new(t||n)(o.Y36(Ti),o.Y36(Si),o.Y36(Oi),o.Y36(_i.H7),o.Y36(o.sBO))},n.\u0275cmp=o.Xpm({type:n,selectors:[["image-cropper"]],viewQuery:function(t,i){if(1&t&&(o.Gf(bi,7),o.Gf(xi,5)),2&t){let r;o.iGM(r=o.CRH())&&(i.wrapper=r.first),o.iGM(r=o.CRH())&&(i.sourceImage=r.first)}},hostVars:4,hostBindings:function(t,i){1&t&&o.NdJ("resize",function(){return i.onResize()},!1,o.Jf7)("mousemove",function(a){return i.moveImg(a)},!1,o.evT)("touchmove",function(a){return i.moveImg(a)},!1,o.evT)("mouseup",function(){return i.moveStop()},!1,o.evT)("touchend",function(){return i.moveStop()},!1,o.evT),2&t&&(o.Udp("text-align",i.alignImage),o.ekj("disabled",i.disabled))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",cropper:"cropper",alignImage:"alignImage",disabled:"disabled"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed"},features:[o.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","load",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,i){1&t&&(o.TgZ(0,"div",null,0),o.YNc(2,yi,2,5,"img",1),o._UZ(3,"div",2),o.YNc(4,wi,3,15,"div",3),o.qZA()),2&t&&(o.Udp("background",i.imageVisible&&i.backgroundColor),o.xp6(2),o.Q6J("ngIf",i.safeImgDataUrl),o.xp6(1),o.Udp("width",i.maxSize.width,"px")("height",i.maxSize.height,"px")("margin-left","center"===i.alignImage?i.marginLeft:null),o.xp6(1),o.Q6J("ngIf",i.imageVisible))},dependencies:[Z.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";top:0;bottom:0;left:0;right:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}'],changeDetection:0}),n})(),Bi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[[Z.ez]]}),n})();var Di=g(6188);function Li(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"div",4)(1,"div",5),o.NdJ("click",function(){o.CHM(t);const r=o.MAs(7);return o.KtG(r.click())}),o._UZ(2,"img",6),o.TgZ(3,"div",7),o._UZ(4,"i",8),o.ALo(5,"translate"),o.qZA(),o.TgZ(6,"input",9,10),o.NdJ("change",function(r){o.CHM(t);const a=o.oxw();return o.KtG(a.fileChangeEvent(r))}),o.qZA()(),o.TgZ(8,"div",11)(9,"div",12)(10,"strong"),o._uU(11),o.qZA(),o.TgZ(12,"div",13)(13,"em",14),o._uU(14),o.qZA()()(),o.TgZ(15,"div",15)(16,"div",16),o._UZ(17,"i",17),o.TgZ(18,"span",18),o._uU(19),o.qZA()(),o.TgZ(20,"div",16),o._UZ(21,"i",19),o.TgZ(22,"span",18),o._uU(23),o.qZA()(),o.TgZ(24,"div",16),o._uU(25),o.ALo(26,"translate"),o.TgZ(27,"em"),o._uU(28),o.ALo(29,"date"),o.qZA()()(),o.TgZ(30,"div",12)(31,"button",20),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.showEditProfilePopUp())}),o._uU(32),o.ALo(33,"translate"),o.qZA()()()()}if(2&n){const t=o.oxw();o.xp6(2),o.Q6J("src",t.user.imageURL,o.LSH),o.xp6(2),o.s9C("title",o.lcZ(5,10,"Click To Upload New Photo")),o.xp6(7),o.AsE("",t.user.firstName," ",t.user.lastName,""),o.xp6(3),o.Oqu(t.user.role),o.xp6(5),o.Oqu(t.user.email),o.xp6(4),o.Oqu(t.user.phoneNumber),o.xp6(2),o.hij(" ",o.lcZ(26,12,"Joined:")," "),o.xp6(3),o.Oqu(o.xi3(29,14,t.user.created_at.toDate(),"MMMM dd, yyyy")),o.xp6(4),o.hij(" ",o.lcZ(33,17,"Edit Profile")," ")}}function Fi(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"div",30),o.NdJ("click",function(){o.CHM(t);const r=o.oxw(2);return o.KtG(r.hideEditPicPopup())}),o.ALo(1,"translate"),o._uU(2," \xd7 "),o.qZA()}2&n&&o.s9C("title",o.lcZ(1,1,"Cancel"))}function Zi(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"div",31)(1,"image-cropper",32),o.NdJ("imageCropped",function(r){o.CHM(t);const a=o.oxw(2);return o.KtG(a.imageCropped(r))})("loadImageFailed",function(){o.CHM(t);const r=o.oxw(2);return o.KtG(r.loadImageFailed())}),o.qZA()()}if(2&n){const t=o.oxw(2);o.xp6(1),o.Q6J("imageChangedEvent",t.imageFile)("maintainAspectRatio",!0)("resizeToWidth",256)("aspectRatio",1)}}function Wi(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"button",33),o.NdJ("click",function(){o.CHM(t);const r=o.oxw(2);return o.KtG(r.saveImg())}),o._uU(1),o.ALo(2,"translate"),o.qZA()}2&n&&(o.xp6(1),o.hij(" ",o.lcZ(2,1,"Save Image")," "))}function qi(n,e){if(1&n&&(o.TgZ(0,"span"),o._uU(1),o.ALo(2,"number"),o.ALo(3,"async"),o.qZA()),2&n){const t=o.oxw(3);o.xp6(1),o.hij("",o.xi3(2,1,o.lcZ(3,4,t.percentage),"1.0-0"),"%")}}function Ni(n,e){if(1&n&&(o.TgZ(0,"div",34)(1,"p",35),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"div",36),o._UZ(5,"progress",37),o.ALo(6,"async"),o.YNc(7,qi,4,6,"span",38),o.ALo(8,"async"),o.qZA()()),2&n){const t=o.oxw(2);o.xp6(2),o.Oqu(o.lcZ(3,3,"Uploading Picture...")),o.xp6(3),o.Q6J("value",o.lcZ(6,5,t.percentage)),o.xp6(2),o.Q6J("ngIf",o.lcZ(8,7,t.percentage))}}function Gi(n,e){if(1&n&&(o.TgZ(0,"p",39),o._uU(1),o.qZA()),2&n){const t=o.oxw(2);o.xp6(1),o.Oqu(t.errorMsg)}}function Qi(n,e){if(1&n&&(o.TgZ(0,"div",21)(1,"div",22)(2,"div",23),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.YNc(5,Fi,3,3,"div",24),o.qZA(),o.TgZ(6,"div",25),o.YNc(7,Zi,2,4,"div",26),o.YNc(8,Wi,3,3,"button",27),o.YNc(9,Ni,9,9,"div",28),o.YNc(10,Gi,2,1,"p",29),o.qZA()()),2&n){const t=o.oxw();o.xp6(3),o.hij(" ",o.lcZ(4,6,"Crop Image")," "),o.xp6(2),o.Q6J("ngIf",!t.uploading),o.xp6(2),o.Q6J("ngIf",t.imageFile),o.xp6(1),o.Q6J("ngIf",t.croppedImage),o.xp6(1),o.Q6J("ngIf",t.uploading),o.xp6(1),o.Q6J("ngIf",t.errorMsg)}}function ji(n,e){if(1&n&&(o.TgZ(0,"p",42),o._uU(1),o.qZA()),2&n){const t=o.oxw(2);o.xp6(1),o.Oqu(t.errorMsg)}}function Yi(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"div",21)(1,"div",22)(2,"div",23),o._uU(3),o.ALo(4,"translate"),o.qZA(),o.TgZ(5,"div",30),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.hideEditProfilePopUp())}),o.ALo(6,"translate"),o._uU(7," \xd7 "),o.qZA()(),o.TgZ(8,"div",25)(9,"app-edit-profile",40),o.NdJ("updatedValues",function(r){o.CHM(t);const a=o.oxw();return o.KtG(a.updateProfile(r))}),o.qZA(),o.YNc(10,ji,2,1,"p",41),o.qZA()()}if(2&n){const t=o.oxw();o.xp6(3),o.hij(" ",o.lcZ(4,4,"Edit Profile")," "),o.xp6(2),o.s9C("title",o.lcZ(6,6,"Cancel")),o.xp6(4),o.Q6J("profileInfos",t.user),o.xp6(1),o.Q6J("ngIf",t.errorMsg)}}function Xi(n,e){if(1&n){const t=o.EpF();o.TgZ(0,"div",43),o.NdJ("click",function(){o.CHM(t);const r=o.oxw();return o.KtG(r.hideAllPopups())}),o.qZA()}}const $i=[{path:"",component:(()=>{class n{constructor(t,i,r){this.route=t,this.usersService=i,this.afStorage=r,this.errorMsg="",this.editProfilePopup=!1,this.editPicPopup=!1,this.imageFile=null,this.uploading=!1,this.showEditProfilePopUp=()=>this.editProfilePopup=!0}ngOnInit(){this.usersService.getCurrentProfile(this.route.snapshot.params.id).subscribe(i=>this.user=i)}updateProfile(t){var i=this;return(0,D.Z)(function*(){try{yield i.usersService.updateProfile(i.user.uid,t),i.hideEditProfilePopUp(),i.hideEditPicPopup()}catch(r){i.errorMsg=r}})()}hideEditProfilePopUp(){this.editProfilePopup=!1,this.errorMsg=""}hideEditPicPopup(){this.editPicPopup=!1,this.uploading=!1,this.errorMsg="",this.percentage=(0,mt.of)(void 0),this.imageFile=null,this.croppedImage=null}fileChangeEvent(t){t.target.files[0]&&(this.imageFile=t,this.errorMsg="",this.editPicPopup=!0)}imageCropped(t){this.croppedImage=t.base64}loadImageFailed(){this.imageFile=null,this.errorMsg="Please, Load a valid image",setTimeout(()=>{this.hideEditPicPopup()},3e3)}saveImg(){this.uploadPhoto(this.croppedImage)}uploadPhoto(t){var i=this;return(0,D.Z)(function*(){if(!t)return;i.uploading=!0;const r=yield(0,ve.Bo)(t),a=`profile-pictures/${i.user.uid}`,s=i.afStorage.ref(a),c=i.afStorage.upload(a,r);i.percentage=c.percentageChanges(),c.snapshotChanges().pipe((0,ye.x)(()=>{s.getDownloadURL().subscribe(l=>{l&&(i.user.imageURL=l,i.updateProfile(i.user).then(()=>i.hideEditPicPopup()))})})).subscribe()})()}hideAllPopups(){this.hideEditProfilePopUp(),this.uploading||this.hideEditPicPopup()}}return n.\u0275fac=function(t){return new(t||n)(o.Y36(pt.gz),o.Y36(we.f),o.Y36(fi))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-profile"]],decls:5,vars:4,consts:[[1,"global-container"],["class","profile-container facebook-style",4,"ngIf"],["class","popup-modal facebook-style",4,"ngIf"],["class","overlay",3,"click",4,"ngIf"],[1,"profile-container","facebook-style"],[1,"img-container",3,"click"],["alt","User's profile picture",1,"profile-photo",3,"src"],[1,"upload-icon-container"],[1,"fas","fa-upload",3,"title"],["type","file","accept","image/*",2,"display","none",3,"change"],["editPicInput",""],[1,"profile-info-container"],[1,"profile-section"],[1,"profile-section",2,"text-align","center"],[2,"font-size","small"],[1,"profile-section",2,"text-align","left","margin","15px 0"],[1,"user-infos"],[1,"fas","fa-envelope"],[1,"span-info"],[1,"fas","fa-phone-square-alt"],[1,"edit-btn",3,"click"],[1,"popup-modal","facebook-style"],[1,"popup-modal-header"],[1,"title"],["class","close-btn",3,"title","click",4,"ngIf"],[1,"popup-modal-body"],["class","img-cropper-container",4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],["class","progress-container",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"close-btn",3,"title","click"],[1,"img-cropper-container"],["format","png",3,"imageChangedEvent","maintainAspectRatio","resizeToWidth","aspectRatio","imageCropped","loadImageFailed"],[1,"btn","btn-success",3,"click"],[1,"progress-container"],[1,"text-warning"],[2,"display","flex","flex-wrap","nowrap"],["max","100",2,"width","100%",3,"value"],[4,"ngIf"],[1,"alert","alert-danger"],[3,"profileInfos","updatedValues"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"overlay",3,"click"]],template:function(t,i){1&t&&(o.TgZ(0,"div",0),o.YNc(1,Li,34,19,"div",1),o.YNc(2,Qi,11,8,"div",2),o.YNc(3,Yi,11,8,"div",2),o.YNc(4,Xi,1,0,"div",3),o.qZA()),2&t&&(o.xp6(1),o.Q6J("ngIf",i.user),o.xp6(1),o.Q6J("ngIf",i.editPicPopup),o.xp6(1),o.Q6J("ngIf",i.editProfilePopup),o.xp6(1),o.Q6J("ngIf",i.editProfilePopup||i.editPicPopup))},dependencies:[Z.O5,gi.z,Hi,Z.Ov,Z.JJ,Z.uU,Di.X$],styles:[".global-container[_ngcontent-%COMP%]{position:relative;min-height:90vh}.profile-container[_ngcontent-%COMP%]{margin:15px auto;padding:15px;width:max-content;min-width:max-content;height:max-content;display:grid;grid-template-columns:repeat(2,minmax(max-content,1fr));gap:15px;justify-content:center;align-items:center}.img-container[_ngcontent-%COMP%]{position:relative;margin:15px;height:250px;display:flex;justify-content:center;align-items:center;margin-inline:auto}.profile-info-container[_ngcontent-%COMP%]{margin:15px;display:flex;flex-direction:column;justify-content:space-between;align-items:center;height:100%}.img-container[_ngcontent-%COMP%]:hover{filter:brightness(75%);transition:.2s}.img-container[_ngcontent-%COMP%]:hover   .fa-upload[_ngcontent-%COMP%]{display:inherit}.profile-photo[_ngcontent-%COMP%]{width:100%;height:100%;margin-inline:auto;border-radius:50%;cursor:pointer}.upload-icon-container[_ngcontent-%COMP%]{position:absolute;top:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center}.fa-upload[_ngcontent-%COMP%]{font-size:4rem;color:#fff;display:none;cursor:pointer}.user-infos[_ngcontent-%COMP%]{margin-block:5px}.span-info[_ngcontent-%COMP%]{margin-left:7px}.edit-btn[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content;padding:.25rem .5rem;margin-left:5px;align-self:center;background-color:var(--mainToSide-color);color:var(--popup-bg-color);border:none;border-radius:3px}.edit-btn[_ngcontent-%COMP%]:hover{filter:brightness(.9)}.img-cropper-container[_ngcontent-%COMP%]{width:100%;height:300px;text-align:center}.popup-modal-body[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.progress-container[_ngcontent-%COMP%]{margin-top:15px}@media screen and (max-width: 650px){.profile-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:max-content;height:100%}}"]}),n})(),canActivate:[xe.a]}];let Ji=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[pt.Bz.forChild($i),pt.Bz]}),n})();var Ki=g(9552),kt=g(2327);let Vi=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[kt.si,kt.BQ,kt.BQ]}),n})(),to=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[Z.ez,Ji,Ki.m,Bi,Vi]}),n})()}}]);