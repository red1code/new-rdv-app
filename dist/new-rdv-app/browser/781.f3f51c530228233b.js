"use strict";(self.webpackChunknew_rdv_app=self.webpackChunknew_rdv_app||[]).push([[781],{7781:(Y,v,i)=>{i.r(v),i.d(v,{RendezvousModule:()=>L});var c=i(6895),p=i(5861),a=i(50),e=i(4650),l=i(6518),_=i(4286),u=i(6188),f=i(7694),m=i(6912),g=i(362);function R(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"app-table",7),e.NdJ("updateInfosEvent",function(s){e.CHM(t);const d=e.oxw();return e.KtG(d.showHalfwayPopup(s))}),e.qZA()()}if(2&n){const t=r.ngIf,o=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,4,"My Approved Rendezvous")),e.xp6(2),e.Q6J("tableCols",o.myApprovedRDVsCols)("infos",t)("currentUser",o.user)}}function Z(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",4)(1,"div",5)(2,"span",6),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"app-table",7),e.NdJ("updateInfosEvent",function(s){e.CHM(t);const d=e.oxw();return e.KtG(d.showHalfwayPopup(s))}),e.qZA()()}if(2&n){const t=r.ngIf,o=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,4,"My Pending Rendezvous")),e.xp6(2),e.Q6J("tableCols",o.myPendingRDVsCols)("infos",t)("currentUser",o.user)}}function y(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Update or Delete this Rendezvous")))}function C(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Update or Call Off this Rendezvous")))}function A(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.TgZ(3,"strong"),e._uU(4),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.hij("- ",e.lcZ(2,2,"Rendezvous Date:")," "),e.xp6(3),e.Oqu(null==t.rdv?null:t.rdv.rdvDate)}}function z(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.deleteRendezvous())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Delete Rendezvous")," "))}function D(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.cancelRendezvous())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"Call Off Rendezvous")," "))}function b(n,r){if(1&n&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.errMsg," ")}}function M(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e.YNc(3,y,3,3,"span",11),e.YNc(4,C,3,3,"span",11),e.qZA(),e.TgZ(5,"div",12),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.hidePopup())}),e.ALo(6,"translate"),e._uU(7," \xd7 "),e.qZA()(),e.TgZ(8,"div",13)(9,"div",14),e._uU(10),e.ALo(11,"translate"),e.TgZ(12,"strong"),e._uU(13),e.qZA(),e._UZ(14,"br"),e._uU(15),e.ALo(16,"translate"),e.TgZ(17,"strong"),e._uU(18),e.qZA(),e._UZ(19,"br"),e.YNc(20,A,5,4,"span",11),e.qZA(),e.TgZ(21,"div",15)(22,"button",16),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.proceedToUpdate())}),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.YNc(25,z,3,3,"button",17),e.YNc(26,D,3,3,"button",17),e.qZA(),e.YNc(27,b,2,1,"div",18),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.isPending),e.xp6(1),e.Q6J("ngIf",t.isApproved),e.xp6(1),e.s9C("title",e.lcZ(6,12,"Cancel")),e.xp6(5),e.hij(" - ",e.lcZ(11,14,"Name:")," "),e.xp6(3),e.Oqu(null==t.rdv?null:t.rdv.displayName),e.xp6(2),e.hij(" - ",e.lcZ(16,16,"Created in:")," "),e.xp6(3),e.Oqu(null==t.rdv?null:t.rdv.createdAt),e.xp6(2),e.Q6J("ngIf",t.isApproved),e.xp6(3),e.hij(" ",e.lcZ(24,18,"Update Rendezvous")," "),e.xp6(2),e.Q6J("ngIf",t.isPending),e.xp6(1),e.Q6J("ngIf",t.isApproved),e.xp6(1),e.Q6J("ngIf",t.errMsg)}}function T(n,r){if(1&n&&(e.TgZ(0,"div",20),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.errMsg," ")}}function I(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"div",10),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",12),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.hidePopup())}),e.ALo(6,"translate"),e._uU(7," \xd7 "),e.qZA()(),e.TgZ(8,"div",13)(9,"app-rdv-form",21),e.NdJ("rdvFormValue",function(s){e.CHM(t);const d=e.oxw();return e.KtG(d.updateRendezvous(s))}),e.qZA(),e.YNc(10,T,2,1,"div",18),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,4,"Updating Rendezvous")," "),e.xp6(2),e.s9C("title",e.lcZ(6,6,"Cancel")),e.xp6(4),e.Q6J("rdv",t.rdv),e.xp6(1),e.Q6J("ngIf",t.errMsg)}}function P(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.hidePopup())}),e.qZA()}}let w=(()=>{class n{constructor(t,o,s,d){this.authService=t,this.rdvService=o,this.translate=s,this.translatingService=d,this.myApprovedRDVsCols=this.translatingService.getApprovedRDVsCols(),this.myPendingRDVsCols=this.translatingService.getPendingRDVsCols(),this.halfwayPopup=!1,this.updatePopup=!1,this.errMsg=""}ngOnInit(){this.authService.getUser().subscribe(t=>{this.user=t,this.user.email&&(this.myApprovedRDVs=this.rdvService.getRDVsByEmailAndState(this.user.email,a.R.APPROVED,"rdvDate"),this.myPendingRDVs=this.rdvService.getRDVsByEmailAndState(this.user.email,a.R.PENDING,"createdAt"))})}showHalfwayPopup(t){this.rdv=t,this.halfwayPopup=!0}proceedToUpdate(){this.halfwayPopup=!1,this.updatePopup=!0}get isPending(){return this.rdv?.rdvState===a.R.PENDING}get isApproved(){return this.rdv?.rdvState===a.R.APPROVED}updateRendezvous(t){var o=this;return(0,p.Z)(function*(){if(!o.rdv?.rdvID)return o.errMsg="Rendezvous not found";if(t.displayName===o.rdv.displayName&&t.phoneNumber===o.rdv.phoneNumber)return o.hidePopup();try{return yield o.rdvService.updateRendezvous(o.rdv.rdvID,t),o.hidePopup()}catch(s){o.errMsg=s}})()}deleteRendezvous(){var t=this;return(0,p.Z)(function*(){if(!t.rdv?.rdvID)return t.errMsg="Rendezvous ID not found";if(confirm(t.translatingService.getDeleteConfirmMsg(t.rdv)))try{return yield t.rdvService.deleteRendezvous(t.rdv.rdvID,t.rdv,t.user),t.hidePopup()}catch(o){t.errMsg=o}})()}cancelRendezvous(){var t=this;return(0,p.Z)(function*(){if(!t.rdv?.rdvID)return t.errMsg="Rendezvous ID not found";if(confirm(t.translatingService.getCancelConfirmMsg(t.rdv))){t.rdv.rdvState=a.R.CANCELED;try{return yield t.rdvService.cancelRendezvous(t.rdv.rdvID,t.rdv,t.user),t.hidePopup()}catch(o){t.errMsg=o}}})()}hidePopup(){this.halfwayPopup=!1,this.updatePopup=!1,this.rdv=null,this.errMsg=""}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.e),e.Y36(_.b),e.Y36(u.sK),e.Y36(f.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-my-rendezvous"]],decls:8,vars:9,consts:[[1,"my-rdvs-container"],["class","facebook-style table-container",4,"ngIf"],["class","popup-modal facebook-style",4,"ngIf"],["class","overlay",3,"click",4,"ngIf"],[1,"facebook-style","table-container"],[1,"t-title-container"],[1,"t-title"],[3,"tableCols","infos","currentUser","updateInfosEvent"],[1,"popup-modal","facebook-style"],[1,"popup-modal-header"],[1,"title"],[4,"ngIf"],[1,"close-btn",3,"title","click"],[1,"popup-modal-body"],[2,"margin","15px 0 30px 0"],[1,"btns-container"],[1,"btn","btn-primary",3,"click"],["class","btn btn-danger",3,"click",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"btn","btn-danger",3,"click"],[1,"alert","alert-danger"],[3,"rdv","rdvFormValue"],[1,"overlay",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.YNc(1,R,6,6,"div",1),e.ALo(2,"async"),e.YNc(3,Z,6,6,"div",1),e.ALo(4,"async"),e.YNc(5,M,28,20,"div",2),e.YNc(6,I,11,8,"div",2),e.YNc(7,P,1,0,"div",3),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,5,o.myApprovedRDVs)),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,7,o.myPendingRDVs)),e.xp6(2),e.Q6J("ngIf",o.halfwayPopup),e.xp6(1),e.Q6J("ngIf",o.updatePopup),e.xp6(1),e.Q6J("ngIf",o.halfwayPopup||o.updatePopup))},dependencies:[c.O5,m.a,g.X,c.Ov,u.X$],styles:[".my-rdvs-container[_ngcontent-%COMP%]{position:relative;width:100%;min-height:100vh;padding:15px}.btns-container[_ngcontent-%COMP%]{margin-top:15px;display:grid;grid-template-columns:1fr 1fr;gap:15px}"]}),n})();var h=i(9116);function N(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9)(2,"span",10),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"app-table",11),e.NdJ("updateInfosEvent",function(s){e.CHM(t);const d=e.oxw();return e.KtG(d.proceedToUpdate(s))}),e.qZA(),e.TgZ(6,"div",12)(7,"button",13),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onPreviousBtn())}),e._uU(8,"Previous Page"),e.qZA(),e.TgZ(9,"button",14),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onNextBtn())}),e._uU(10,"Next Page"),e.qZA()()()}if(2&n){const t=r.ngIf,o=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,5,"Approved Rendezvous")),e.xp6(2),e.Q6J("tableCols",o.rdvCol)("infos",t)("showBtns",!1)("currentUser",o.user)}}function U(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Create New Rendezvous")))}function V(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"Update Rendezvous")))}function J(n,r){if(1&n&&(e.TgZ(0,"p",23),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.formErrorMsg)}}function E(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"div",17),e.YNc(3,U,3,3,"span",18),e.YNc(4,V,3,3,"span",18),e.qZA(),e.TgZ(5,"div",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.hidePopup())}),e.ALo(6,"translate"),e._uU(7," \xd7 "),e.qZA()(),e.TgZ(8,"div",20)(9,"app-rdv-form",21),e.NdJ("rdvFormValue",function(s){e.CHM(t);const d=e.oxw();return e.KtG(d.submitRDVform(s))}),e.qZA(),e.YNc(10,J,2,1,"p",22),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",!t.rdv),e.xp6(1),e.Q6J("ngIf",t.rdv),e.xp6(1),e.s9C("title",e.lcZ(6,6,"Cancel")),e.xp6(4),e.Q6J("rdv",t.rdv)("showDeleteBtn",!1),e.xp6(1),e.Q6J("ngIf",t.formErrorMsg)}}function S(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.hidePopup())}),e.qZA()}}let q=(()=>{class n{constructor(t,o,s){this.authService=t,this.rdvService=o,this.translatingService=s,this.rdvCol=this.translatingService.getApprovedRDVsCols(),this.showForm=!1,this.formErrorMsg="",this.rdv=null}ngOnInit(){this.approvedRDVs=this.rdvService.getRDVsByState(a.R.APPROVED,"rdvDate","BEGINNING"),this.authService.getUser().subscribe(t=>{this.user=t}),this.setLastDoc()}onNextBtn(){this.rdvService.getDocByID(this.lastDoc.id).get().subscribe(t=>{this.approvedRDVs=this.rdvService.getRDVsByState(a.R.APPROVED,"rdvDate","NEXT",t),this.setLastDoc(),this.setFirstDoc()})}onPreviousBtn(){this.rdvService.getDocByID(this.firstDoc.id).get().subscribe(t=>{this.approvedRDVs=this.rdvService.getRDVsByState(a.R.APPROVED,"rdvDate","PREVIOUS",t),this.setLastDoc(),this.setFirstDoc()})}setLastDoc(){this.approvedRDVs.subscribe(t=>{this.rdvService.getDocByID(t[t.length-1].rdvID).snapshotChanges().subscribe(s=>this.lastDoc=s.payload)})}setFirstDoc(){this.approvedRDVs.subscribe(t=>{this.rdvService.getDocByID(t[0].rdvID).snapshotChanges().subscribe(s=>this.firstDoc=s.payload)})}proceedToUpdate(t){this.rdv=t,this.showForm=!0}showPopup(){this.showForm=!0}hidePopup(){this.showForm=!1,this.formErrorMsg="",this.rdv=null}submitRDVform(t){var o=this;return(0,p.Z)(function*(){if(o.user.email){if(!o.rdv?.rdvID)try{yield o.rdvService.createRendezvous(t,o.user)}catch(s){o.formErrorMsg=s}if(o.rdv?.rdvID)try{yield o.rdvService.updateRendezvous(o.rdv.rdvID,t)}catch(s){o.formErrorMsg=s}o.hidePopup()}else o.formErrorMsg="You need Email to create new Rendezvous!"})()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.e),e.Y36(_.b),e.Y36(f.o))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-rendezvous"]],decls:11,vars:8,consts:[[1,"rdv-container"],[1,"newRDV-btn-container"],[1,"btn","btn-success",3,"click"],[1,"far","fa-calendar-plus"],[2,"margin-left","7px"],["class","facebook-style table-container rdv-table",4,"ngIf"],["class","popup-modal facebook-style",4,"ngIf"],["class","overlay",3,"click",4,"ngIf"],[1,"facebook-style","table-container","rdv-table"],[1,"t-title-container"],[1,"t-title"],[3,"tableCols","infos","showBtns","currentUser","updateInfosEvent"],[2,"margin","5px","text-align","center"],[1,"btn","btn-info",3,"click"],[1,"btn","btn-info",2,"margin-left","5px",3,"click"],[1,"popup-modal","facebook-style"],[1,"popup-modal-header"],[1,"title"],[4,"ngIf"],[1,"close-btn",3,"title","click"],[1,"popup-modal-body"],[3,"rdv","showDeleteBtn","rdvFormValue"],["class","text-danger",4,"ngIf"],[1,"text-danger"],[1,"overlay",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return o.showPopup()}),e._UZ(3,"i",3),e.TgZ(4,"span",4),e._uU(5),e.ALo(6,"translate"),e.qZA()()(),e.YNc(7,N,11,7,"div",5),e.ALo(8,"async"),e.YNc(9,E,11,8,"div",6),e.YNc(10,S,1,0,"div",7),e.qZA()),2&t&&(e.xp6(5),e.Oqu(e.lcZ(6,4,"New Rendezvous")),e.xp6(2),e.Q6J("ngIf",e.lcZ(8,6,o.approvedRDVs)),e.xp6(2),e.Q6J("ngIf",o.showForm),e.xp6(1),e.Q6J("ngIf",o.showForm))},dependencies:[c.O5,m.a,g.X,c.Ov,u.X$],styles:[".rdv-container[_ngcontent-%COMP%]{position:relative;padding:15px;margin:0 auto;min-width:300px;max-width:90%}.newRDV-btn-container[_ngcontent-%COMP%]{margin-bottom:15px}.newRDV-btn-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{box-shadow:0 0 11px #0006}.rdv-table[_ngcontent-%COMP%]{max-width:100%!important}@media screen and (max-width: 950px){.rdv-container[_ngcontent-%COMP%]{max-width:100%}}"]}),n})();var x=i(6471);const O=[{path:"",component:q,canActivate:[x.a]},{path:"my-rendezvous",component:w,canActivate:[x.a]}];let k=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.Bz.forChild(O),h.Bz]}),n})();var F=i(9552);let L=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[c.ez,k,F.m]}),n})()}}]);